import pandas as pd

# Create the player ID to age mapping dictionary
player_ages_dict = {
    1628983: 26, 1630162: 23, 203999: 30, 203507: 30, 1628369: 27,
    1630595: 23, 1626164: 28, 1628973: 28, 1629639: 25, 1629027: 26,
    1628378: 28, 1626157: 29, 201142: 36, 1630224: 23, 201935: 35,
    1628368: 27, 2544: 40, 201939: 37, 203081: 34, 203897: 30,
    201942: 35, 1627783: 30, 1628991: 25, 1630178: 24, 1629636: 25,
    1627750: 28, 1631114: 23, 1629014: 25, 1627759: 28, 1630578: 22,
    1629632: 25, 202681: 32, 1629008: 26, 1628969: 28, 1630532: 23,
    1630559: 26, 1629673: 25, 1628389: 27, 202696: 34, 1630596: 23,
    1630169: 25, 1630163: 23, 1627736: 28, 1628970: 27, 203468: 33,
    1630530: 24, 1629628: 24, 1641705: 21, 1627734: 28, 1626181: 31,
    203076: 32, 1630217: 26, 1627826: 28, 1628401: 30, 203944: 30,
    1630567: 23, 1631101: 21, 1628384: 27, 1628370: 27, 1629029: 26,
    1631128: 23, 1631097: 22, 1629675: 25, 1629661: 29, 1630166: 24,
    1629012: 26, 1629630: 25, 1630202: 27, 203952: 30, 1626167: 28,
    1628386: 26, 1642264: 20, 1641718: 21, 1629631: 27, 1628415: 29,
    1628404: 30, 202699: 32, 1631094: 22, 1626162: 29, 1630700: 22,
    1630183: 24, 1628374: 27, 202691: 35, 1629656: 24, 201572: 36,
    203471: 31, 1630581: 22, 1630170: 24, 1641708: 22, 203078: 31,
    201566: 36, 1629640: 25, 1631099: 24, 203084: 32, 1630168: 24,
    1627741: 32, 1630598: 26, 1630703: 21, 1641711: 21, 1628398: 29,
    1631105: 21, 1629660: 27, 1628381: 27, 1627751: 29, 1642377: 21,
    202685: 32, 1629130: 30, 1642258: 19, 1629627: 24, 202710: 35,
    1630230: 27, 1641731: 20, 203915: 31, 1641739: 24, 1627832: 31,
    1626145: 28, 1629023: 26, 1630557: 26, 1626156: 29, 1630553: 23,
    1630583: 24, 203501: 33, 1630552: 23, 1630167: 27, 203924: 31,
    1629599: 27, 1627884: 28, 1629018: 26, 1642259: 19, 202331: 34,
    1629060: 27, 203497: 32, 1629638: 26, 1626179: 31, 1627824: 29,
    204001: 29, 1630577: 23, 1627777: 31, 1642261: 23, 1631108: 22,
    1626171: 30, 1630590: 24, 1629655: 26, 1642267: 19, 1627747: 30,
    1630592: 24, 1629652: 25, 1629651: 25, 1630541: 22, 204456: 32,
    1628978: 28, 1631117: 23, 1630198: 25, 1630228: 22, 1630560: 23,
    101108: 39, 1626220: 31, 1641729: 21, 1641710: 21, 203903: 32,
    1629645: 24, 1631106: 23, 1631095: 21, 1630175: 24, 201950: 34,
    203484: 32, 1642274: 20, 203932: 29, 1629028: 26, 1631124: 22,
    1641706: 22, 1628960: 29, 1630591: 23, 1630534: 24, 1630533: 23,
    1630245: 25, 1631109: 23, 1630540: 24, 1641722: 22, 1629614: 25,
    1631110: 21, 1631165: 25, 1627752: 30, 1628989: 26, 1627749: 28,
    1641764: 22, 1629634: 28, 1628392: 26, 1642273: 21, 1631093: 23,
    1642271: 21, 1628379: 28, 203110: 35, 202695: 33, 201144: 37,
    1628976: 25, 1641744: 22, 1628449: 32, 1641824: 20, 1631170: 24,
    1631107: 21, 1642268: 20, 203991: 30, 1630193: 25, 1641783: 23,
    1641717: 21, 1630208: 27, 1630188: 25, 1641733: 20, 1641709: 22,
    1630182: 24, 1631260: 25, 1629048: 25, 1630573: 27, 203992: 32,
    203954: 31, 1630172: 23, 1630527: 23, 1631212: 22, 201143: 38,
    1642276: 20, 1630558: 26, 1631213: 26, 1630631: 26, 1631222: 23,
    1641842: 19, 1627827: 31, 1626166: 30, 1630241: 28, 1630548: 24,
    1630625: 25, 203114: 33, 1642347: 22, 1627742: 27, 1641741: 23,
    1641715: 20, 1642346: 22, 1631323: 29, 1630702: 22, 1641730: 20,
    1629611: 28, 1629021: 27, 1630549: 23, 1629312: 28, 1630174: 25,
    1629622: 28, 1630643: 27, 1630191: 23, 1631218: 25, 1629216: 28,
    1630551: 23, 1626168: 29, 1627739: 31,
    1627780: 32,
    1630215: 24,
    1628418: 27,
    1642272: 21,
    1631096: 22,
    203552: 34,
    1641716: 21,
    1642266: 20,
    1629726: 28,
    1642270: 21,
    1628371: 27,
    1630200: 25,
    1628380: 27,
    1629026: 30,
    203994: 30,
    1628436: 29,
    1629750: 31,
    1628998: 29,
    1631217: 23,
    1641763: 21,
    1642348: 21,
    1630526: 24,
    1641767: 23,
    1630249: 24,
    1626172: 29,
    1627763: 32,
    203486: 35,
    1628997: 29,
    1629637: 24,
    203482: 33,
    1642419: 23,
    1629003: 28,
    1630570: 24,
    203083: 31,
    1641726: 21,
    1630173: 25,
    1627936: 31,
    1628988: 28,
    1631204: 24,
    1642366: 25,
    1629659: 24,
    1629674: 25,
    203995: 31,
    1642367: 23,
    1629731: 28,
    1628366: 27,
    201569: 36,
    1630572: 25
}

# Read the CSV file
csv_file = 'nba_player_stats_2024-25_leaders.csv'
df = pd.read_csv(csv_file)

# Add the Age column to the dataframe
df['Age'] = df['PLAYER_ID'].map(player_ages_dict)

# Save the updated dataframe back to CSV
df.to_csv(csv_file, index=False)
print(f"Added Age column to the dataframe and saved to {csv_file}")